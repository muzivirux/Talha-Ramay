<!DOCTYPE html>
<html>
  <head>
    <title>Finished product Form</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
    <link rel="icon" href="./images/favico.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>

  <body>
    <!-- Logo -->
    <div class="logo">
      <a href="https://rafiqfarmfoods.com/" target="_blank">
        <img id="logoImg" src="/images/rff.png" />
      </a>
    </div>

    <!-- Form -->
    <h1>Finished product Form</h1>
    <div id="line"></div>
    <form id="FinishedproductForm">
      <!-- Wapda -->

      <!-- second three -->
      <div class="section">
        <h2>Finished Product Status</h2>
        <div class="section-content">
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Batch Code & Cut size</label>
              <input
                type="text"
                id="wapdaoffpeakend"
                name="Batch Code & Cut size"
                placeholder="Enter Batch code"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Total IQF packed(kg)</label>
              <input
                type="number"
                min="0"
                id="wapdatotal"
                name="Total IQF packed(kg)"
                rplaceholder="Enter Total IQF packed"
                step=".1"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Avg.FP Temperature</label>
              <input
                type="text"
                id="wapdaoffpeakend"
                name="Avg.FP Temperature"
                placeholder="Enter Temperature"
              />
            </div>
          </div>

          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Waste(kg)</label>
              <input
                type="number"
                id="wapdaoffpeakend"
                name="Waste(kg)"
                placeholder="Enter Waste (kg)"
                step=".1"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Starting product waste</label>
              <input
                type="number"
                min="0"
                id="wapdatotal"
                name="Starting product waste"
                placeholder="Enter Starting product"
                step=".1"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Ending product waste</label>
              <input
                type="number"
                id="wapdaoffpeakend"
                name="Ending product waste"
                placeholder="Enter Ending product"
                min="0"
                step=".1"
              />
            </div>
          </div>
        </div>
      </div>

      <!-- third three -->
      <div class="section">
        <h2>Product Holding Log</h2>
        <div class="section-content">
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Batch Code</label>

              <input
                type="text"
                id="gen1Units"
                name="Batch Code for product holding log"
                placeholder="Enter Batch Code"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Series</label>
              <input
                type="text"
                id="gen1diesel"
                name="Series"
                placeholder="Enter Series"
              />
            </div>
            <div class="wrapper">
              <label for="RSD">Holding Reason</label>
              <input
                type="text"
                id="gen1diesel"
                name="Holding Reason"
                placeholder="Enter Holding Reason"
              />
            </div>
          </div>
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Hold Product (kg)</label>
              <input
                type="text"
                id="gen1diesel"
                name="Hold Product (kg)"
                placeholder="Enter Hold Product (kg)"
                step=".1"
              />
            </div>
            <div class="wrapper">
              <label for="RSD">QA Rep</label>
              <input
                type="text"
                id="gen1diesel"
                name="QA Rep"
                placeholder="Enter QA Rep"
              />
            </div>
          </div>
        </div>
      </div>
      <div class="section">
        <h2>Line Downtime Log</h2>
        <div class="section-content">
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Line stop</label>

              <input
                type="text"
                id="gen1Units"
                name="Line stop"
                placeholder="Enter Line stop"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Line Start</label>
              <input
                type="text"
                id="gen1diesel"
                name="Line Start"
                placeholder="Enter Line Start"
              />
            </div>
            <div class="wrapper">
              <label for="RSD">Downtime(m)</label>
              <input
                type="text"
                id="gen1diesel"
                name="Downtime(m)"
                placeholder="Enter Downtime(m)"
              />
            </div>
          </div>
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Description of problem</label>
              <input
                type="text"
                id="gen1diesel"
                name="Description of problem"
                placeholder="Enter Description of problem"
              />
            </div>
            <div class="wrapper">
              <label for="RSD">Maintainace Technician</label>
              <input
                type="text"
                id="gen1diesel"
                name="Maintainace Technician"
                placeholder="Enter Maintainace Technician"
              />
            </div>
          </div>
        </div>
      </div>
      <div class="section">
        <h2>Steam Peeler Log</h2>
        <div class="section-content">
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Time (HH:MM)</label>
              <input
                type="time"
                id="gen1diesel"
                name="Time(HH:MM) peeler log"
                placeholder="Enter Time"
                min="0"
              />
            </div>
            <div class="wrapper">
              <label for="RSD">Gate open %</label>
              <input
                type="text"
                id="gen1diesel"
                name="Gate open % peeler log"
                placeholder="Enter Gate open %"
                min="0"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Speed(Hz)</label>
              <input
                type="text"
                id="gen1diesel"
                name="Speed(Hz) peeler log"
                placeholder="Enter Speed(Hz)"
                min="0"
              />
            </div>
          </div>

          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Time(sec)</label>
              <input
                type="number"
                id="gen1diesel"
                name="Time(sec) peeler log"
                placeholder="Enter Time(sec)"
                min="0"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Steam pressure</label>
              <input
                type="text"
                id="gen1diesel"
                name="Steam pressure peeler log"
                placeholder="Enter Steam pressure"
                min="0"
              />
            </div>
            <div class="wrapper">
              <label for="RSD">Remarks</label>
              <input
                type="text"
                id="gen1diesel"
                name="Remarks peeler log"
                placeholder="Enter Remarks"
                min="0"
              />
            </div>
          </div>
        </div>
      </div>
      <div class="section">
        <h2>RM Details</h2>
        <div class="section-content">
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">LIR ref. </label>

              <input
                type="text"
                id="gen1Units"
                name="LIR ref."
                placeholder="Enter LIR ref."
              />
            </div>
            <div class="wrapper">
              <label for="RSD">Vehicle </label>

              <input
                type="text"
                id="gen1Units"
                name="Vehicle"
                placeholder="Enter Vehicle "
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Feed start </label>
              <input
                type="text"
                id="gen1Units"
                name="Feed start"
                placeholder="Enter Feed start "
              />
            </div>
          </div>
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Feed Stop </label>
              <input
                type="text"
                id="gen1Units"
                name="Feed Stop"
                placeholder="Enter Feed Stop"
              />
            </div>
            <div class="wrapper">
              <label for="RSD">Weight(kg) </label>
              <input
                type="number"
                id="gen1Units"
                name="Weight(kg)"
                placeholder="Enter Weight(kg)"
                step=".1"
              />
            </div>
            <div class="wrapper">
              <label for="RSD">Remarks</label>
              <input
                type="text"
                id="gen1Units"
                name="Remarks"
                placeholder="Enter Remarks"
              />
            </div>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>Equipment Parameters</h2>
        <div class="section-content">
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Inspection Time</label>
              <input
                type="time"
                id="gen1Units"
                name="Inspection Time"
                placeholder="Enter Inspection Time "
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Hopper speed(Hz)</label>
              <input
                type="text"
                id="gen1Units"
                name="Hopper speed(Hz)"
                placeholder="Enter Hopper speed(Hz)"
              />
            </div>
          </div>
        </div>
      </div>
      <div class="section">
        <h2>Blancher-1</h2>
        <div class="section-content">
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Time(min)</label>
              <input
                type="text"
                id="gen1Units"
                name="Time(min) for Blancher-1"
                placeholder="Enter Time(min)"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Temperature(^C)</label>
              <input
                type="text"
                id="gen1Units"
                name="Temperature(^C) for Blancher-1"
                placeholder="Enter Temperature(^C)"
              />
            </div>
          </div>
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Weight Loss</label>
              <input
                type="number"
                id="gen1Units"
                name="Weight Loss for Blancher-1"
                placeholder="Enter Weight Loss"
                min="0"
                step=".1"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Avg. Blancher -1 w. loss %</label>
              <input
                type="text"
                id="gen1Units"
                name="Avg. Blancher -1 w. loss %"
                placeholder="Enter Avg. Blancher -1 w. loss %"
              />
            </div>
          </div>
        </div>
      </div>
      <div class="section">
        <h2>Blancher-2</h2>
        <div class="section-content">
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Time(min)</label>
              <input
                type="text"
                id="gen1Units"
                name="Time(min) for Blancher-2"
                placeholder="Enter Time(min)"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Temperature(^C)</label>
              <input
                type="text"
                id="gen1Units"
                name="Temperature(^C) for Blancher-2"
                placeholder="Enter Temperature(^C)"
              />
            </div>
          </div>
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Weight Loss</label>
              <input
                type="number"
                id="gen1Units"
                name="Weight Loss for Blancher-2"
                placeholder="Enter Weight Loss"
                min="0"
                step=".1"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Avg. Blancher -2 w. loss %</label>
              <input
                type="text"
                id="gen1Units"
                name="Avg. Blancher -2 w. loss %"
                placeholder="Enter Avg. Blancher -2 w. loss %"
              />
            </div>
          </div>
        </div>
      </div>
      <div class="section">
        <h2>Dryer</h2>
        <div class="section-content">
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Time(min)</label>
              <input
                type="text"
                id="gen1Units"
                name="Time(min) for Dryer"
                placeholder="Enter Time(min)"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Temperature(^C)</label>
              <input
                type="text"
                id="gen1Units"
                name="Temperature(^C) for Dryer"
                placeholder="Enter Temperature(^C)"
              />
            </div>
          </div>
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Weight Loss</label>
              <input
                type="number"
                id="gen1Units"
                name="Weight Loss for Dryer"
                placeholder="Enter Weight Loss"
                min="0"
                step=".1"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Avg. Dryer w. loss % </label>
              <input
                type="text"
                id="gen1Units"
                name="Avg. Dryer  w. loss %"
                placeholder="Enter Avg. Dryer  w. loss %"
              />
            </div>
          </div>
        </div>
      </div>
      <div class="section">
        <h2>Fryer</h2>
        <div class="section-content">
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Time(min)</label>
              <input
                type="text"
                id="gen1Units"
                name="Time(min) for Fryer"
                placeholder="Enter Time(min)"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Temperature(^C)</label>
              <input
                type="text"
                id="gen1Units"
                name="Temperature(^C) for Fryer"
                placeholder="Enter Temperature(^C)"
              />
            </div>
          </div>
          <div class="RSD">
            <div class="wrapper">
              <label for="RSD">Weight Loss</label>
              <input
                type="number"
                id="gen1Units"
                name="Weight Loss for Fryer"
                placeholder="Enter Weight Loss"
                min="0"
                step=".1"
              />
            </div>

            <div class="wrapper">
              <label for="RSD">Avg. Fryer w. loss % </label>
              <input
                type="text"
                id="gen1Units"
                name="Avg. Dryer  w. loss %"
                placeholder="Enter Avg. Fryer  w. loss %"
              />
            </div>
          </div>
        </div>
      </div>

      <input type="submit" value="Submit" />
    </form>

    <!-- spinner html -->
    <div class="spinner-container">
      <div class="spinner"></div>
    </div>
    <!-- end of spinner html -->

    <!-- Add the modal HTML code -->
    <div id="myModal" class="modal">
      <span class="close">&times;</span>
      <div class="modal-content">
        <p id="modal-message"></p>
        <button id="closeBtn">Close</button>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <p>
        <a href="https://rafiqfarmfoods.com/" target="_blank"
          >Copyright &copy; Rafiq Farm Foods | All Right Reserved.
        </a>
      </p>
    </footer>
    <!-- end of Footer -->

    <script>
      const scriptURL =
        "https://script.google.com/macros/s/AKfycbxxCBNeIApJdw2KodcPSpRosJfLuIhWoha-xf_657kGyl93_m4qVU4BQM-meFgg-b8B9Q/exec";
      const form = document.getElementById("FinishedproductForm");

      // modal javascript
      // Get the modal element, the close button, and the close button inside the modal
      const modal = document.getElementById("myModal");
      const closeBtn = document.querySelector(".close");
      const modalCloseBtn = document.getElementById("closeBtn");

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        modal.style.display = "block";
        fetch(scriptURL, { method: "POST", body: new FormData(form) })
          .then((response) => {
            if (!areAllFieldsHidden()) hideSpinner(); // Hide the spinner

            document.getElementById("modal-message").textContent = "Success!";
          })
          .catch((error) => {
            hideSpinner(); // Hide the spinner
            document.getElementById("modal-message").textContent =
              "Error! " + error.message;
          });
      });
      // Close the modal when the close button is clicked
      closeBtn.addEventListener("click", () => {
        modal.style.display = "none";
      });
      // Close the modal when the close button inside the modal is clicked
      modalCloseBtn.addEventListener("click", () => {
        modal.style.display = "none";
      });
    </script>

    <!-- reseting form after submitting -->
    <script>
      document
        .getElementById("FinishedproductForm")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Prevent the default form submission

          this.reset();
        });
    </script>
    <!-- end of for reseting after submitting -->

    <script>
      // Function to show the spinner
      function showSpinner() {
        const spinnerContainer = document.querySelector(".spinner-container");
        spinnerContainer.style.display = "flex";
        modal.style.display = "none";
      }

      // Function to hide the spinner
      function hideSpinner() {
        const spinnerContainer = document.querySelector(".spinner-container");
        spinnerContainer.style.display = "none";
        modal.style.display = "block";
      }

      // Function to handle form submission
      function handleSubmit(event) {
        event.preventDefault();
        showSpinner(); // Show the spinner
      }

      // Add event listener to form submit

      form.addEventListener("submit", handleSubmit);
    </script>
    <!-- End of spinner -->

    <!-- check time validations -->
    <script>
      // Get the input element
      var durationInput = document.getElementById("availability-duration");
      durationInput.addEventListener("change", function () {
        durationInput.setCustomValidity("");
        var value = durationInput.value;
        var hours = parseInt(value.split(":")[0]);
        var minutes = parseInt(value.split(":")[1]);
        if (isNaN(hours) || isNaN(minutes) || minutes >= 60) {
          durationInput.setCustomValidity(
            "Please enter a valid duration in HH:MM format with hours under 23 and minutes under 60."
          );
        }
      });
    </script>

    <!-- Hidden functionalities are here -->
    <script>
      // Function to toggle the required attribute of input elements
      function toggleRequired(inputs, isRequired) {
        inputs.forEach((input) => {
          input.required = isRequired;
        });
      }

      // Function to hide content between headings
      function hideContentBetweenHeadings() {
        const sections = document.querySelectorAll(".section");
        sections.forEach((section) => {
          const content = section.querySelector(".section-content");
          content.style.display = "none";
        });
      }

      // Function to check if all input fields are hidden
      function areAllFieldsHidden() {
        const sections = document.querySelectorAll(".section");
        return [...sections].every((section) => {
          const content = section.querySelector(".section-content");
          return content.style.display === "none";
        });
      }

      // Add an event listener for when the form is submitted
      document.querySelector("form").addEventListener("submit", function (e) {
        if (areAllFieldsHidden()) {
          spinnerContainer.style.display = "none";
          e.preventDefault(); // Prevent form submission
          alert(
            "Please fill in at least one field before submitting the form."
          );
        }
      });

      // Toggle content visibility and required attribute on click
      function toggleContentAndRequired() {
        const sections = document.querySelectorAll(".section");
        sections.forEach((section) => {
          const heading = section.querySelector("h2");
          const content = section.querySelector(".section-content");

          heading.addEventListener("click", () => {
            // Toggle the visibility of the content within the section
            content.style.display =
              content.style.display === "none" ? "block" : "none";

            // Determine if the content is now visible or hidden
            const isContentVisible = content.style.display === "block";

            // Get all the input elements within the content
            const inputElements = content.querySelectorAll("input");

            // Toggle the "required" attribute based on visibility
            toggleRequired(inputElements, isContentVisible);
          });
        });
      }

      // Add an event listener for when the page is fully loaded
      window.addEventListener("load", () => {
        hideContentBetweenHeadings();
        toggleContentAndRequired();
      });
    </script>
    <script>
      // Function to check if all input fields are hidden
      function areAllFieldsHidden() {
        const sections = document.querySelectorAll(".section");
        return [...sections].every((section) => {
          const content = section.querySelector(".section-content");
          return content.style.display === "none";
        });
      }

      // Function to hide the modal
      function hideModal() {
        const modal = document.getElementById("myModal");
        modal.style.display = "none";
      }

      // Add an event listener for when the form is submitted
      document.querySelector("form").addEventListener("submit", function (e) {
        if (areAllFieldsHidden()) {
          e.preventDefault(); // Prevent form submission
          alert(
            "Please fill in at least one field before submitting the form."
          );

          // Hide the spinner, message, and modal
          const spinnerContainer = document.querySelector(".spinner-container");
          spinnerContainer.style.display = "none";
          hideModal();
        }
      });
    </script>
  </body>
</html>
